# ë©€í‹° ì“°ë ˆë“œ í”„ë¡œê·¸ë˜ë°

### ğŸ“–ëª©í‘œ

> ìë°”ì˜ ë©€í‹° ì“°ë ˆë“œ í”„ë¡œê·¸ë˜ë°ì— ëŒ€í•´ í•™ìŠµí•˜ì—¬ë¼

<br>

## í”„ë¡œì„¸ìŠ¤ì™€ ì“°ë ˆë“œ

í”„ë¡œê·¸ë˜ë°ì„ ê³µë¶€í•˜ê±°ë‚˜ ë©´ì ‘ì—ì„œ ë‹¹ê³¨ë¡œ ë‚˜ì˜¤ëŠ” ì§ˆë¬¸ ì¤‘ í•˜ë‚˜ëŠ” í”„ë¡œì„¸ìŠ¤ì™€ ì“°ë ˆë“œ ê·¸ë¦¬ê³  ê·¸ ë‘˜ì˜ ì°¨ì´ì ì¼ ê²ƒì´ë‹¤. êµ¬ê¸€ë§ì„ í†µí•´ ìì„¸íˆ ì„¤ëª…í•´ ë‘” ê²ƒë“¤ì´ êµ‰ì¥íˆ ë§ìœ¼ë‹ˆ ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•˜ê²Œ ì§šê³  ë„˜ì–´ê°€ë„ë¡ í•˜ê² ë‹¤.

#### í”„ë¡œì„¸ìŠ¤

> í”„ë¡œì„¸ìŠ¤ëŠ” ìš°ë¦¬ê°€ í”íˆ ì•Œê³  ìˆëŠ” í”„ë¡œê·¸ë¨ì´ OSë¡œ ë¶€í„° ë©”ëª¨ë¦¬ì— í• ë‹¹ë°›ì•„ ì‹¤í–‰ë˜ê³  ìˆëŠ” ìƒíƒœë¥¼ ë§í•œë‹¤. ì£¼ë³€ì— ê°€ê¹Œìš´ ì‹œì„ ìœ¼ë¡œ ë¹„êµí•˜ìë©´, ê³µì¥ì— ì–´ë–¤ ì‘ì—…ì„ ìœ„í•´ ì‘ì—…ëŒ€ í•˜ë‚˜ë¥¼ ë§ˆë ¨í•œê²ƒê³¼ ê°™ë‹¤. ì„œë¡œ ë‹¤ë¥¸ ì‘ì—…ëŒ€(í”„ë¡œì„¸ìŠ¤)ëŠ” ê°ì ê³µê°„ì„ í• ë‹¹ ë°›ê¸° ë•Œë¬¸ì— ë…ë¦½ì ìœ¼ë¡œ ì„œë¡œ ë‹¤ë¥¸ ì‘ì—…ëŒ€ì— ì˜í–¥ì„ ë¼ì¹  ìˆ˜ ì—†ë‹¤. ì¡°ê¸ˆ ë” ë“¤ì–´ê°€ë³´ìë©´, í”„ë¡œì„¸ìŠ¤ë¼ë¦¬ë„ í†µì‹ ì„ í•˜ì—¬ ì •ë³´ë¥¼ ì£¼ê³  ë°›ì„ ìˆ˜ëŠ” ìˆë‹¤.

### ì“°ë ˆë“œ

> ì“°ë ˆë“œëŠ” í”„ë¡œì„¸ìŠ¤ ì•ˆì—ì„œ ì‘ì—…ì„ í•˜ëŠ” ì£¼ì²´ë¼ê³  ë§í•  ìˆ˜ ìˆë‹¤. ì¦‰, í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ëœ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ì´ ëŒì•„ê°ˆ ìˆ˜ ìˆë„ë¡ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³  ì‚¬ìš©ìì˜ ëª…ë ¹ì„ ìˆ˜í–‰í•˜ëŠ” ì—­í• ì„ ë§¡ëŠ”ë‹¤. ê³µì¥ì— ì‘ì—…ëŒ€ê°€ ì¡´ì¬í•œë‹¤ë©´ ê·¸ ì•ˆì— ì¼í•˜ëŠ” ì‚¬ëŒì´ ìˆì–´ì•¼ ë¬¼ê±´ì„ ë§Œë“¤ìˆ˜ ìˆë“¯ í”„ë¡œì„¸ìŠ¤ë¼ëŠ” ì‘ì—…ëŒ€ì—ëŠ” ì“°ë ˆë“œë¼ëŠ” ì›Œì»¤ê°€ ì¼ì„ í•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤. 
>
> ì›Œì»¤ëŠ” í•œ ì‚¬ëŒì´ ë  ìˆ˜ ìˆê³  ì—¬ëŸ¬ ì‚¬ëŒ(**ë©€í‹° ì“°ë ˆë“œ**)ì´ ë  ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ëª…ì´ì„œ ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ì—¬ ë¹ ë¥´ê²Œ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆê³  ë‹¤ë¥¸ ì¢…ë¥˜ì˜ ì¼ì„ í•  ìˆ˜ ë„ ìˆëŠ” ê²ƒì´ë‹¤. í•˜ë‚˜ì˜ ì‘ì—…ëŒ€ ì•ˆì—ì„œ ì¼í•˜ê¸° ë•Œë¬¸ì— íŠ¹ë³„í•œ ìˆ˜ë‹¨ ì—†ì´ë„ ë°ì´í„°ë¥¼ ê³µìœ í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  ìì‹ ì´ ì–´ë””ê¹Œì§€ ì¼í–ˆëŠ”ê°€ë¥¼ ì•Œê¸° ìœ„í•´ì„œëŠ” ì‘ì—… ì¼ì§€(Stack ì˜ì—­)ëŠ” ì„œë¡œ ê°€ì§€ê³  ìˆë‹¤. ì‘ì—…ëŒ€ë¥¼ ê³µìœ í•˜ê³  ìˆê¸°ì— í•˜ë‚˜ì˜ ì›Œì»¤ê°€ ì‘ì—…ëŒ€ë¥¼ ë§ì¹œë‹¤ë©´, ë‹¤ë¥¸ ì›Œì»¤ë“¤ ê¹Œì§€ë„ ë©ˆì¶œ ìˆ˜ ë°–ì— ì—†ë‹¤.

<br>

## ì“°ë ˆë“œì˜ ì¢…ë¥˜

ìë°”ì—ì„œëŠ” ë‘ ì¢…ë¥˜ì˜ ì“°ë ˆë“œë¥¼ ì œê³µí•œë‹¤. ì´ëŠ” **User Threadì™€ Daemon Thread** ì´ë‹¤.

* User Thread

  > ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì“°ë ˆë“œë¡œ JVMì€ í•´ë‹¹ ì“°ë ˆë“œì˜ ì‘ì—…ì´ ëë‚  ë•Œê¹Œì§€ ì¢…ë£Œë˜ì§€ ì•Šê³  ê¸°ë‹¤ë¦°ë‹¤.

* Daemon Thread

  > ìš°ì„ ìˆœìœ„ê°€ ë‚®ì€ ì“°ë ˆë“œë¡œ ìœ ì € ì“°ë ˆë“œì˜ ì‘ì—…ì„ ë„ì™€ì£¼ëŠ” ì—­í• ì„ í•œë‹¤. ë§Œì•½, ëª¨ë“  ìœ ì € ì“°ë ˆë“œê°€ ì¢…ë£Œ ëœë‹¤ë©´ ë°ëª¬ ì“°ë ˆë“œ ë˜í•œ ë°”ë¡œ ì¢…ë£Œëœë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ë°ëª¬ ì“°ë ˆë“œ ì•ˆì—ì„œ ë¬´í•œ ë£¨í”„ ë¡œì§ì´ ìˆì–´ë„ ë¬¸ì œë¥¼ ì•¼ê¸°í•˜ì§€ ì•ŠëŠ”ë‹¤.
  > (I/O ì‘ì—…ì„ ë°ëª¬ ì“°ë ˆë“œ ì•ˆì—ì„œëŠ” ë¹„ ì¶”ì²œ)
  >
  > ë°ëª¬ ì“°ë ˆë“œì˜ ëŒ€í‘œì ì¸ ì˜ˆê°€ ë°”ë¡œ Garbage Collectionì´ë‹¤. 
  >
  > ì´ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ê¸°ë³¸ì ì¸ ì“°ë ˆë“œì™€ ê°™ì´ ìƒì„±í•œ ë’¤ setDaemon ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¤ì •ì„ í•´ì£¼ë©´ ëœë‹¤.

<br>

## ë©”ì¸ ì“°ë ˆë“œ

ìë°” í”„ë¡œê·¸ë¨ì´ ì‹œì‘ë˜ë©´ JVMì— ì˜í•´ ì“°ë ˆë“œ í•˜ë‚˜ê°€ ë°”ë¡œ ì‹¤í–‰ë˜ëŠ”ë° ì´ë¥¼ ë©”ì¸ ì“°ë ˆë“œë¼ê³  í•œë‹¤. ë©”ì¸ ì“°ë ˆë“œì—ì„œëŠ” ì²«ë²ˆì§¸ë¡œ  main ë©”ì†Œë“œì˜ ì¡´ì¬ë¥¼ í™•ì¸í•˜ê³  ì´í›„ í´ë˜ìŠ¤ë¥¼ ì´ˆê¸°í™” í•œë‹¤.(JDK 6ë¶€í„° main ë©”ì†Œë“œ í•„ìˆ˜) ì´ëŸ¬í•œ ë©”ì¸ ì“°ë ˆë“œì—ì„œ ìœ ì € ì“°ë ˆë“œ í˜¹ì€ ë°ëª¬ ì“°ë ˆë“œë¥¼ ìƒì„±í•˜ì—¬ ì‚¬ìš©í•œë‹¤. ë§Œì•½ ë©”ì¸ ì“°ë ˆë“œ ì™¸ì— ìœ ì € ì“°ë ˆë“œê°€ ì•„ì§ë„ ì‘ì—…ì¤‘ì´ë¼ë©´, ë©”ì¸ ì“°ë ˆë“œê°€ ì¢…ë£Œë˜ì–´ë„ í”„ë¡œê·¸ë¨ì€ ì¢…ë£Œë˜ì§€ ì•ŠëŠ”ë‹¤.

![](https://media.geeksforgeeks.org/wp-content/uploads/main-thread-in-java.jpeg)

ì¶œì²˜ : [Main thread in Java - GeeksforGeeks](https://www.geeksforgeeks.org/main-thread-java/)

<br>

## ì“°ë ˆë“œ ìƒì„±í•˜ê¸°

ìë°”ì—ì„œ ì´ ì“°ë ˆë“œë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì€ 2ê°€ì§€ê°€ ì¡´ì¬í•œë‹¤.

1. Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„
2. Thread í´ë˜ìŠ¤ë¥¼ ìƒì†

### Runnable ì¸í„°í˜ì´ìŠ¤

Runnable ì¸í„°í˜ì´ìŠ¤ì˜ ê²½ìš° ì¶”ìƒ ë©”ì†Œë“œë¡œ run ë©”ì†Œë“œë§Œ ì¡´ì¬í•œë‹¤.

```java
public interface Runnable {
    public abstract void run();
}
```

ì¦‰, ì“°ë ˆë“œë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰ì‹œì— ì–´ë– í•œ ë™ì‘ì„ í• ì§€ êµ¬í˜„í•˜ê³  ì´ë¥¼ ì“°ë ˆë“œ ìƒì„±ì‹œì— ì¸ìë¡œ ë„˜ê²¨ì£¼ê¸°ë§Œ í•˜ë©´ ëœë‹¤.

```java
public class App {
    public static void main(String[] args) {
        Thread customThread = new Thread(new CustomThread());
        customThread.start();
    }
}

class CustomThread implements Runnable {
    @Override
    public void run() {
        System.out.println("Custom Thread ì‹¤í–‰.");
    }
}
```

ìœ„ì™€ ê°™ì´ ì“°ë ˆë“œ ìƒì„±ì‹œì—ëŠ” ì½˜ì†”ì— ""Custom Thread ì‹¤í–‰." ì´ë¼ëŠ” ë¬¸êµ¬ê°€ ë‚˜ì˜¤ê²Œ ëœë‹¤.

ìœ„ ë°©ì‹ ë§ê³ ë„ ëŒë‹¤ í˜¹ì€ ìµëª… ê°ì²´ë¥¼ í†µí•´ì„œë„ ìƒì„±ì´ ê°€ëŠ¥í•˜ë‹¤.

```java
// ìµëª… ê°ì²´
Thread customThread = new Thread() {
	@Override
	public void run() {
		System.out.println("Custom Thread ì‹¤í–‰.");
	}
};

// ëŒë‹¤
Thread customThread = new Thread(() -> {
	System.out.println("Custom Thread ì‹¤í–‰.");
});
```

### Thread í´ë˜ìŠ¤ ìƒì†

Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ”ê²ƒ ì™¸ì— Thread í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ìƒì† ë°›ì•„ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” Thread ê°ì²´ ë˜í•œ Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.

```java
class CustomThread extends Thread {
    @Override
    public void run() {
        System.out.println("Custom Thread ì‹¤í–‰.");
    }
}
```

í•˜ì§€ë§Œ, ìœ„ì™€ ê°™ì´ ìš°ë¦¬ê°€ ì›í•˜ëŠ”ëŒ€ë¡œ Threadë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” run ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í•  ìˆ˜ ë°–ì— ì—†ë‹¤. ê·¸ëƒ¥ Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ”ê²ƒê³¼ ë‹¤ë¥¼ ë°”ê°€ ì—†ì–´ ë³´ì¸ë‹¤. ë§ì€ ë¸”ë¡œê·¸ ê¸€ì—ì„œë„ ì´ì™€ ê°™ì€ ìƒí™©ì„ ë§í•˜ê³  ìˆìœ¼ë©°, **Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ë¼ê³  ê¶Œì¥**í•˜ê³  ìˆë‹¤. ì´ëŠ” Thread í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ê²Œ ë˜ë©´ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì„ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤. í•„ìê°€ ë³´ê¸°ì—ë„ Threadë¥¼ ì§ì ‘ ìƒì†ë°›ëŠ”ê²ƒ ë³´ë‹¤ëŠ” Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì¡°ê¸ˆ ë” ì´ì ì´ ìˆì„ ê²ƒì´ë¼ê³  íŒë‹¨ëœë‹¤.

<br>

## ì“°ë ˆë“œì˜ ìƒíƒœ

ì“°ë ˆë“œëŠ” ì—¬ëŸ¬ê°€ì§€ ìƒíƒœë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” getState ë©”ì†Œë“œë¡œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.

![](http://voyager.deanza.edu/~hso/cis35a/lecture/java14/images/Picture3.png)

ì¶œì²˜ : [Threads Introduction Life cycle](http://voyager.deanza.edu/~hso/cis35a/lecture/java14/intro/lifecycle.html)

* NEW

  > ìƒì„±ë§Œ ë˜ê³  ì•„ì§ ì‹¤í–‰ë˜ì§€ ì•Šì€ ìƒíƒœ

* RUNNABLE

  > ì‹¤í–‰ì´ ê°€ëŠ¥í•œ ìƒíƒœë¡œ ìì›ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì„ ìˆ˜ë„ ìˆìŒ

* BLOCKED

  > ê³µìœ  ë½ì´ í’€ë¦´ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ìƒíƒœ

* WAITING

  > Object.wait, Thread.join, LockSupport.park ì¤‘ í•˜ë‚˜ë¥¼ í˜¸ì¶œí•˜ì—¬ notify í˜¹ì€ joinì´ ëë‚˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ìƒíƒœ

* TIMED_WAITING

  > ì§€ì •ëœ ëŒ€ê¸° ì‹œê°„ì´ ì¡´ì¬í•˜ëŠ” ìƒíƒœë¡œ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œ ê²½ìš°
  >
  > * Thread.sleep
  > * Object.wait (timeout ì¡´ì¬)
  > * Thread.join (timeout ì¡´ì¬)
  > * LockSupport.parkNanos
  > * LockSupport.parkUntil

* TERMINATED

  > ì“°ë ˆë“œê°€ ì‹¤í–‰ì„ ì™„ë£Œí•˜ì—¬ ì¢…ë£Œëœ ìƒíƒœ

<br>

## ì“°ë ˆë“œ ìš°ì„ ìˆœìœ„

ìš°ì„  ìˆœìœ„ë¥¼ ì•Œê¸° ì „ì— ì“°ë ˆë“œì˜ ë™ì‹œì„±ê³¼ ë³‘ë ¬ì„±ì— ëŒ€í•´ ì‚´í´ë³´ë„ë¡ í•˜ì.

* ë™ì‹œì„±(Concurrency)

  1ê°œì˜ CPU ì½”ì–´ì—ì„œ ì¼ì •í•œ ì£¼ê¸°ë§ˆë‹¤ ì‹¤í–‰í•˜ë©° ì£¼ê¸°ê°€ êµ‰ì¥íˆ ì§§ì•„ ë™ì‹œì— ì§„í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” ê²ƒ

* ë³‘ë ¬ì„±(Parallelism)

  ì—¬ëŸ¬ê°œ CPU ì½”ì–´ì—ì„œ ì—¬ëŸ¬ê°œì˜ ì“°ë ˆë“œê°€ ë™ì‹œì— ì‘ì—…ì´ ì´ë£¨ì–´ì§€ëŠ” ê²ƒ

CPU ì½”ì–´ì˜ ìˆ˜ì™€ ì“°ë ˆë“œì˜ ìˆ˜ê°€ ë™ì¼í•˜ì—¬ ë™ì‹œì— ì‘ì—…ì´ ì´ë£¨ì–´ì§€ë©´ ì¢‹ê² ì§€ë§Œ ê·¸ë ‡ì§€ ì•Šì„ ê²½ìš°ê°€ ìˆë‹¤. ë™ì‹œì— ì—¬ëŸ¬ê°œê°€ ì‹¤í–‰ë˜ì–´ì•¼í•  ë•Œ ì–´ë–¤ ê²ƒì´ ë¨¼ì € ì‹¤í–‰ë˜ì–´ì•¼ í• ê¹Œ? ì´ëŸ¬í•œ ê²½ìš°ì— ì–´ë–¤ ì“°ë ˆë“œë¥¼ ë¨¼ì € ì‹¤í–‰ì‹œí‚¬ì§€ë¥¼ ì •í•˜ê²Œ ë˜ëŠ”ë° ì´ë¥¼ **ì“°ë ˆë“œ ìŠ¤ì¼€ì¤„ë§**ì´ë¼ê³  í•œë‹¤.

ì“°ë ˆë“œ ìŠ¤ì¼€ì¤„ë§ì—ëŠ” ë‘ê°€ì§€ ë°©ë²•ì´ ì¡´ì¬í•˜ëŠ”ë° í•˜ë‚˜ëŠ” ìš°ì„ ìˆœìœ„ ë°©ì‹ì´ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” Round-Robin ë°©ì‹ì´ë‹¤.

* **ìš°ì„ ìˆœìœ„ ë°©ì‹**

  ë§ ê·¸ëŒ€ë¡œ ìš°ì„  ìˆœìœ„ë¥¼ ì •í•˜ê³  ë†’ì€ ìš°ì„  ìˆœìœ„ë¥¼ ê°€ì§„ ì“°ë ˆë“œê°€ ìš°ì„  ì‹¤í–‰ëœë‹¤. 1 ~ 10 ê¹Œì§€ ì •í•  ìˆ˜ ìˆìœ¼ë©°, 10ì´ ê°€ì¥ ë†’ë‹¤. ìš°ì„  ìˆœìœ„ë¥¼ í• ë‹¹í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ê°’ìœ¼ë¡œ 5ë¡œ ì„¤ì •ëœë‹¤.

  ì“°ë ˆë“œ í´ë˜ìŠ¤ì—ì„œëŠ” MAX_PRIORITY, NORM_PRIORITY, MIN_PRIORITYë¼ëŠ” ìƒìˆ˜ ê°’ì„ ê°€ì§€ê³  ìˆìœ¼ë©° ê°ê° 10, 5, 1ì„ ê°€ë¦¬í‚¨ë‹¤.

  ````java
  Thread thread1 = new Thread(() -> System.out.println("Thread 1"));
  Thread thread2 = new Thread(() -> System.out.println("Thread 2"));
  Thread thread3 = new Thread(() -> System.out.println("Thread 3"));
  
  thread1.setPriority(Thread.MAX_PRIORITY);
  thread2.setPriority(Thread.NORM_PRIORITY);
  thread3.setPriority(Thread.MIN_PRIORITY);
  
  System.out.println(thread1.getPriority());	// 10
  System.out.println(thread2.getPriority());	// 5
  System.out.println(thread3.getPriority());	// 1
  ````

* **Round-Robin**

  CPU ìŠ¤ì¼€ì¤„ë§ì—ì„œì˜ ê·¸ ë¼ìš´ë“œ ë¡œë¹ˆ ë°©ì‹ê³¼ ë™ì¼í•˜ë©°, ì¼ì • ì‹œê°„ë™ì•ˆë§Œ ì“°ë ˆë“œì˜ ì‘ì—…ì„ ì‹¤í–‰í•˜ê³  ê·¸ ë‹¤ìŒ ì‘ì—…ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤. ì´ëŠ” JVM ì•ˆì—ì„œ ì„¤ì •í•˜ê¸° ë•Œë¬¸ì— ê°œë°œìê°€ ì„¤ì •í•  ìˆ˜ ì—†ë‹¤.

<br>

## ë™ê¸°í™”

ë™ê¸°í™”ë€, ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ë¥¼ ì¼ì¹˜ì‹œí‚¤ëŠ” ê²ƒì„ ë§í•œë‹¤. ë©€í‹° ì“°ë ˆë“œ í™˜ê²½ì—ì„œ ì—¬ëŸ¬ê°œì˜ ì“°ë ˆë“œë“¤ì´ í•˜ë‚˜ì˜ ê³µìœ  ìì›ì„ ì‚¬ìš©í•˜ê³ ìˆì„ ë•Œ ë™ì‹œì— ì ‘ê·¼í•˜ë©´ ë°ì´í„°ì˜ ë¶ˆì¼ì¹˜ê°€ ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤.

ë§Œì•½, ì‹­ë§Œì„ ì¹´ìš´íŒ…í•˜ëŠ” ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì“°ë ˆë“œë¥¼ 2ê°œë¥¼ ë§Œë“¤ì–´ ë³´ì.

```java
class SharedObject {
    private int value = 0;

    public void counting() {
        for(int i = 0; i < 100000; i++) value++;
    }

    public int getValue() {
        return value;
    }
}

public class Main extends Thread {
    public static void main(String[] args) throws InterruptedException {
        SharedObject sharedObject = new SharedObject();

        Thread thread1 = new Thread(sharedObject::counting);
        Thread thread2 = new Thread(sharedObject::counting);

        thread1.start();
        thread2.start();

        sleep(1000);
        System.out.println(sharedObject.getValue());
    }
}
```

ê²°ê³¼ëŠ” ì–´ë–»ê²Œ ë‚˜ì˜¬ê¹Œ? ë‹¹ì—°í•˜ê²Œ 200,000ì´ ë‚˜ì˜¬ê²ƒì´ë¼ ìƒê°ì„ í•  ìˆ˜ ìˆë‹¤. ê·¸ ìƒê°ê³¼ëŠ” ë‹¤ë¥´ê²Œ ì´ì‹­ë§Œì´ ê¼­ ë‚˜ì˜¨ë‹¤ëŠ” ë³´ì¥ì„ í•  ìˆ˜ ì—†ë‹¤.

ì™œ ê·¸ëŸ°ê²ƒì¼ê¹Œ? ì´ëŠ” ë‘ê°œì˜ ì“°ë ˆë“œê°€ ë³‘ë ¬ë¡œ ì‹¤í–‰ë˜ë©´ì„œ ë”í•˜ëŠ” ë„ì¤‘ì— ë°”ë€Œì§€ ì•Šì€ ê°’ì— ì ‘ê·¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¼ê¹Œ?

ë°”ë¡œ ë©”ì†Œë“œì— **synchronized í‚¤ì›Œë“œ**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤. ì´ëŠ” ì‚¬ìš©ëœ ê³µê°„(ë©”ì†Œë“œ, ë¸”ëŸ­)ì— ë½ì„ ê±¸ì–´ ë‹¤ë¥¸ ì“°ë ˆë“œê°€ ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ ë§‰ëŠ”ë‹¤.

```java
public synchronized int locking() {
  // ë©”ì†Œë“œ ì „ì²´ Lock
}

public int locking() {
  // Lockì´ ê±¸ë¦¬ì§€ ì•ŠëŠ” ê³µê°„
  synchronized(ê³µìœ  ê°ì²´) {
  	// LOCKì´ ê±¸ë¦°ëŠ” ê³µê°„
  }
  // Lockì´ ê±¸ë¦¬ì§€ ì•ŠëŠ” ê³µê°„
}
```

ì´ì œ ìœ„ì˜ ì˜ˆì œ ì½”ë“œì—ì„œ counting ë©”ì†Œë“œì— synchronized í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ê³  ì‹¤í–‰í•´ë³´ì.

```java
class SharedObject {
    private int value = 0;

    public synchronized void counting() {
        for(int i = 0; i < 100000; i++) value++;
    }

    public int getValue() {
        return value;
    }
}
```

ì´ì œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì´ì‹­ë§Œì´ ë‚˜ì˜¤ê²Œ ë  ê²ƒì´ë‹¤.

<br>

## ë°ë“œë½(êµì°©ìƒíƒœ)

ì™¸ë‚˜ë¬´ ë‹¤ë¦¬ ìœ„ì˜ ë‘ ë§ˆë¦¬ ì—¼ì†Œë€ ì±…ì„ ì–´ë ¸ì„ ì ì— ì½ì–´ ë³¸ ê²½í—˜ì´ ë‹¤ë“¤ ìˆì„ ê²ƒì´ë‹¤. ì„œë¡œ ê°ˆ ê¸¸ì„ ì–‘ë³´í•˜ì§€ ì•Šê³  ìì‹ ì´ ê°€ê¸°ë§Œì„ ì›í•´ ì„œë¡œ ì‹¸ìš°ëŠ” ì´ì•¼ê¸°ì´ë‹¤.

<p align="center"><img src="image/deadlock.png"></p>

ì„œë¡œ ì‹¸ì›€ì„ í•˜ëŠ” ì—¼ì†Œì™€ ê°™ì´ "ì“°ë ˆë“œ A"ëŠ” "ìì› B"ë¥¼ "ì“°ë ˆë“œ B"ëŠ” "ìì› A"ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ ì›í•˜ê³  ìˆì§€ë§Œ, ìì‹ ì´ ì ìœ í•œ ìì›ì€ ê³„ì†í•´ì„œ ì ìœ í•˜ê³  ìˆëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì¦‰, ë°ë“œë½(êµì°©ìƒíƒœ)ì€ ì´ì™€ ê°™ì´ ë‘˜ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ í˜¹ì€ ì“°ë ˆë“œê°€ ì„œë¡œ ê°€ì§€ê³  ìˆëŠ” ìì›ì„ ì›í•˜ë©´ì„œ ìì‹ ì˜ ìì›ì„ ì–‘ë³´í•˜ì§€ ì•Šì•„ ì´ë„ì €ë„ í•˜ì§€ ëª»í•˜ëŠ” ìƒí™©ì„ ë§í•œë‹¤.

ë°ë“œë½ ìƒíƒœê°€ ë°œìƒí•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì¡°ê±´ì´ ë§Œì¡±í•´ì•¼ ëœë‹¤.

* ìƒí˜¸ë°°ì œ

  > ìì›ì„ í•œë²ˆì— í•œ í”„ë¡œì„¸ìŠ¤/ì“°ë ˆë“œë§Œ ì‚¬ìš©

* ì ìœ  ëŒ€ê¸°

  > ìµœì†Œí•œ í•˜ë‚˜ì˜ ìì›ì„ ì ìœ í•˜ê³  ìˆìœ¼ë©° ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤/ì“°ë ˆë“œì— í• ë‹¹ëœ ìì›ì„ ì¶”ê°€ì ìœ¼ë¡œ ì ìœ í•˜ê¸° ìœ„í•´ ëŒ€ê¸°

* ë¹„ì„ ì 

  > ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ëœ ìì›ì€ ê°•ì œë¡œ ëºì„ ìˆ˜ ì—†ìŒ

* ìˆœí™˜ëŒ€ê¸°

  > ê° í”„ë¡œì„¸ìŠ¤/ì“°ë ˆë“œê°€ ìˆœí™˜ì ìœ¼ë¡œ ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤/ì“°ë ˆë“œì˜ ìì›ì„ ìš”êµ¬

ìœ„ì™€ ê°™ì€ ì¡°ê±´ í•˜ë‚˜ë¼ë„ ë§Œì¡±í•˜ì§€ ì•Šìœ¼ë©´ ë°ë“œë½ ìƒíƒœê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.

### ì“°ë ˆë“œ êµì°©ìƒíƒœ ë§Œë“¤ê¸°

ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ë“œë½ ìƒíƒœë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```java
public class Main {
    public static void main(String[] args) {
        Object o1 = new Object();
        Object o2 = new Object();

      	// t1ì€ o1ì„ ì ìœ í•˜ê³  ìˆëŠ” ìƒíƒœì—ì„œ o2ë¥¼ ìš”êµ¬
        Thread t1 = new Thread(new DeadLockThread(o1, o2, "Thread1"));
      	// t2ëŠ” o2ë¥¼ ì ìœ í•˜ê³  ìˆëŠ” ìƒíƒœì—ì„œ o1ì„ ìš”êµ¬
        Thread t2 = new Thread(new DeadLockThread(o2, o1, "Thread2"));

        t1.start();
        t2.start();
    }
}

class DeadLockThread extends Thread {
    Object o1, o2;

    DeadLockThread(Object o1, Object o2, String name) {
        this.o1 = o1;
        this.o2 = o2;
        this.setName(name);
    }

    @Override
    public void run() {
      	// o1ì„ ë¨¼ì € ì„ ì í•˜ê³  ìˆìŒ
        synchronized (this.o1) {
            System.out.println(this.getName() + " holding : " + this.o1);
            try {
                Thread.sleep(1000);
                System.out.println(this.getName() + " waiting : " + this.o2);
              	// ì¶”ê°€ì ìœ¼ë¡œ o2ë¥¼ ìš”ì²­
                synchronized (this.o2) {
                    System.out.println(this.getName() + " holding : " + this.o2);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
}
```

<p align="center"><img src="image/deadlock_code.png"></p>

<br>

---

### Reference

* [Class Thread - Oracle doc java 8](https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html)
* [Main thread in Java - GeeksforGeeks](https://www.geeksforgeeks.org/main-thread-java/)
* [JAVA ì“°ë ˆë“œë€(Thread) ? - JAVAì—ì„œ ë©€í‹°ì“°ë ˆë“œ ì‚¬ìš©í•˜ê¸° - ê¸°ë¡í•˜ëŠ” ê°œë°œì Blog](https://honbabzone.com/java/java-thread/#%EB%8F%99%EC%8B%9C%EC%84%B1%EA%B3%BC-%EB%B3%91%EB%A0%AC%EC%84%B1)
* [Daemon Threads in Java - Baeldung](https://www.baeldung.com/java-daemon-thread)
* [Processes and Threads - The Javaâ„¢ Tutorials](https://docs.oracle.com/javase/tutorial/essential/concurrency/procthread.html)
* [Enum Thread.State - Oracle doc java 11](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Thread.State.html#RUNNABLE)
* [Java - Thread Deadlock](https://www.tutorialspoint.com/java/java_thread_deadlock.htm)